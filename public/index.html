<!DOCTYPE html>
<html lang="en">
  <head>
    <title>EML to HTML</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="robots" content="index, follow" />
    <meta name="description"
          content="Convert .eml files to HTML instantly. Drag and drop an .eml email file to view and extract its HTML content directly in your browser. No signup required." />
    <meta name="keywords"
          content="eml converter, eml viewer, eml to html, email to html, parse eml file, view eml online, .eml reader, rfc822 viewer" />

    <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <body class="bg-gray-100">
    <header class="p-4">
      <h1 class="text-4xl">
        EML to HTML
      </h1>

      <p class="text-lg">
        Drag n' drop, or select an <code>.eml</code> file to upload. We'll extract the HTML.
      </p>
    </header>

    <main class="p-4">
      <div id="drop-area"
           class="group rounded-lg border-2 border-dashed border-gray-300
                  min-h-[75vh] flex flex-col place-items-center justify-center
                  gap-4 text-lg cursor-pointer">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-upload-icon lucide-upload size-20 text-gray-300"><path d="M12 3v12"/><path d="m17 8-5-5-5 5"/><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/></svg>
        <div class="select-none">
          Drag n' drop, or
          click to select an <code>.eml</code> file to upload
        </div>
      </div>

      <input id="file-input" type="file" accept=".eml,message/rfc822" class="hidden" />

      <textarea id="text-area"
                class="hidden min-h-[75vh] w-full rounded-lg p-4 font-mono text-sm">
      </textarea>
    </main>
    <footer class="p-4 text-sm text-gray-700">
      <ul class="md:flex gap-8 list-disc list-inside">
        <li>
          <a target="_blank" href="https://www.linkedin.com/in/markmconnell/"
              class="hover:text-sky-700 transition duration-250 border-b border-gray-300 hover:border-sky-300">
            Made by Mark Connell
          </a>
        </li>
        <li>
          <a target="_blank" href="https://github.com/mconnell/eml2html"
              class="hover:text-sky-700 transition duration-250 border-b border-gray-300 hover:border-sky-300">
            View source code on GitHub
          </a>
        </li>
        <li>
          Uploaded data is immediately discarded after processing
        </li>
      </ul>
    </footer>

    <script>
      const dropArea  = document.getElementById("drop-area");
      const fileInput = document.getElementById("file-input");
      const textArea  = document.getElementById("text-area");

      async function handleFile(file) {
        const fileContent = await file.text();

        const response = await fetch("/eml", {
          method: "POST",
          headers: { "Content-Type": "text/plain" },
          body: fileContent,
        });

        const data = await response.json();

        textArea.innerHTML = data.html;
        textArea.classList.remove("hidden");
        dropArea.classList.add("hidden");
      }

      fileInput.addEventListener("change", (e) => {
        handleFile(e.target.files[0])
      });

      dropArea.addEventListener("click", () => {
        fileInput.click();
      });

      dropArea.addEventListener("dragover", (e) => {
        e.preventDefault();
        dropArea.classList.add("border-blue-500", "bg-blue-50");
      });

      dropArea.addEventListener("dragleave", () => {
        dropArea.classList.remove("border-blue-500", "bg-blue-50");
      });

      dropArea.addEventListener("drop", (e) => {
        e.preventDefault();
        dropArea.classList.remove("border-blue-500", "bg-blue-50");
        handleFile(e.dataTransfer.files[0]);
      });
    </script>
  </body>
</html>
